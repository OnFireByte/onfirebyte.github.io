---
import BlogLayout from "@/layouts/Blog.astro";
import { Image } from "astro:assets";
import { getCollection, type CollectionEntry } from "astro:content";

export async function getStaticPaths() {
    const posts = await getCollection("blog");
    return posts.map((post) => ({
        params: { slug: post.slug },
        props: post,
    }));
}

type Props = CollectionEntry<"blog">;
const post = Astro.props;
const { Content } = await post.render();
---

<BlogLayout
    title={post.data.title}
    tags={post.data.tags}
    og={post.data.cover?.src}
>
    {
        post.data.cover && (
            <div class="not-prose">
                <Image
                    src={post.data.cover}
                    alt={post.data.title}
                    class={`mx-auto mt-0 aspect-auto h-[228px] object-cover md:h-[300px] lg:h-[420px] ${post.data.image_position}`}
                    transition:name={`image-${post.slug}`}
                />
            </div>
        )
    }
    <h1 transition:name={`title-${post.slug}`}>{post.data.title}</h1>
    <div class="mb-8 flex gap-2 text-sm">
        {
            post.data.tags.map((v) => (
                <div class="not-prose">
                    <a
                        href={`/blog/tag/${v}`}
                        class="not-prose rounded-full bg-maindark px-2 py-1 text-mainlight"
                    >
                        {v}
                    </a>
                </div>
            ))
        }
    </div>
    <Content />
</BlogLayout>
